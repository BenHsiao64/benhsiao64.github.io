<!DOCTYPE html>
<html>
<head>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    #captureButton {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 9999;
      padding: 10px;
      background: #fff;
      border: 1px solid #000;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <a-scene
    vr-mode-ui="enabled: false;"
    loading-screen="enabled: false;"
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
    embedded
  >
    <a-marker preset="hiro">
      <a-box position="0 0.5 0" material="color: red;"></a-box>
      <a-image src="path_to_your_image.png" scale="1 1 1"></a-image>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <button id="captureButton" onclick="captureAR()">Capture AR</button>

  <script>
    function captureAR() {
      // Get the A-Frame scene element
      const scene = document.querySelector("a-scene");

      // Set the background color to white temporarily for capturing the screenshot
      scene.setAttribute("background", "color: white");

      // Wait for the next frame to ensure A-Frame has updated the scene
      requestAnimationFrame(() => {
        // Capture the scene as an image using html2canvas
        html2canvas(scene.canvas).then(function (canvas) {
          // Convert the captured canvas to a data URL
          const dataURL = canvas.toDataURL("image/png");

          // Create a download link for the captured image
          const link = document.createElement("a");
          link.href = dataURL;
          link.download = "ar_screenshot.png";
          document.body.appendChild(link);

          // Automatically trigger the download
          link.click();

          // Clean up the temporary elements
          document.body.removeChild(link);

          // Restore the original background color
          scene.setAttribute("background", "color: black");
        });
      });
    }
  </script>
</body>
</html>
